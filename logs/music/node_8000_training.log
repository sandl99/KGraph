[05/27/2021 16:15:03.879 train.py:182] Parameter dataset := music
[05/27/2021 16:15:03.879 train.py:182] Parameter aggregator := sum
[05/27/2021 16:15:03.880 train.py:182] Parameter n_epochs := 500
[05/27/2021 16:15:03.880 train.py:182] Parameter neighbor_sample_size_train := -1
[05/27/2021 16:15:03.880 train.py:182] Parameter neighbor_sample_size_eval := -1
[05/27/2021 16:15:03.880 train.py:182] Parameter dim := 16
[05/27/2021 16:15:03.880 train.py:182] Parameter n_iter := 1
[05/27/2021 16:15:03.881 train.py:182] Parameter batch_size := 512
[05/27/2021 16:15:03.881 train.py:182] Parameter l2_weight := 1e-05
[05/27/2021 16:15:03.881 train.py:182] Parameter lr := 0.01
[05/27/2021 16:15:03.881 train.py:182] Parameter ratio := 1
[05/27/2021 16:15:03.881 train.py:182] Parameter save_dir := ./kgraph_models
[05/27/2021 16:15:03.881 train.py:182] Parameter lr_decay := 0.5
[05/27/2021 16:15:03.881 train.py:182] Parameter sampler := node
[05/27/2021 16:15:03.882 train.py:182] Parameter size_subg_edge := 8000
[05/27/2021 16:15:03.882 train.py:182] Parameter batch_size_eval := 256
[05/27/2021 16:15:03.882 train.py:185] Loading knowledge graph from data
[05/27/2021 16:15:03.974 train.py:187] Loading ratings data
[05/27/2021 16:15:04.225 train.py:194] Done loading data in 0.155
[05/27/2021 16:15:07.266 train.py:204] Device: cuda
[05/27/2021 16:15:07.267 train.py:205] Total number of parameters = 181072
[05/27/2021 16:15:07.267 train.py: 90] 
----- Starting training phase 1 ------ Estimator Epoch: 2
[05/27/2021 16:15:07.267 train.py: 95] -------- Mini epoch: 0 --------
[05/27/2021 16:15:08.527 train.py:106] Sampling sub graph in  1.260 seconds
[05/27/2021 16:15:08.667 train.py:111] Building DataLoader in  0.139 seconds
[05/27/2021 16:15:09.260 train.py:133] Train loss: 0.09970231919928833
[05/27/2021 16:15:09.273 train.py:137] Train AUC : 0.5093492427908886
[05/27/2021 16:15:09.274 train.py:138] Train F1  : 0.5276227678571429
[05/27/2021 16:15:09.274 train.py: 95] -------- Mini epoch: 1 --------
[05/27/2021 16:15:10.636 train.py:106] Sampling sub graph in  1.362 seconds
[05/27/2021 16:15:10.776 train.py:111] Building DataLoader in  0.140 seconds
[05/27/2021 16:15:11.222 train.py:133] Train loss: 0.07570803524167449
[05/27/2021 16:15:11.236 train.py:137] Train AUC : 0.5327062592871901
[05/27/2021 16:15:11.236 train.py:138] Train F1  : 0.546063890473474
[05/27/2021 16:15:11.369 train.py:162] Eval loss: 0.7283649742603302
[05/27/2021 16:15:11.379 train.py:166] Eval AUC : 0.4931005059428204
[05/27/2021 16:15:11.379 train.py:167] Eval F1  : 0.4956439839886979
[05/27/2021 16:15:12.018 train.py: 90] 
----- Starting training phase 2 ------ Estimator Epoch: 2
[05/27/2021 16:15:12.019 train.py: 95] -------- Mini epoch: 0 --------
[05/27/2021 16:15:13.480 train.py:106] Sampling sub graph in  1.461 seconds
[05/27/2021 16:15:13.631 train.py:111] Building DataLoader in  0.151 seconds
[05/27/2021 16:15:14.073 train.py:133] Train loss: 0.06733939141311028
[05/27/2021 16:15:14.090 train.py:137] Train AUC : 0.5494431223640535
[05/27/2021 16:15:14.090 train.py:138] Train F1  : 0.5539521860865819
[05/27/2021 16:15:14.090 train.py: 95] -------- Mini epoch: 1 --------
[05/27/2021 16:15:15.447 train.py:106] Sampling sub graph in  1.356 seconds
[05/27/2021 16:15:15.581 train.py:111] Building DataLoader in  0.134 seconds
[05/27/2021 16:15:16.031 train.py:133] Train loss: 0.07030257141148602
[05/27/2021 16:15:16.044 train.py:137] Train AUC : 0.5635683639310792
[05/27/2021 16:15:16.045 train.py:138] Train F1  : 0.5599156118143461
[05/27/2021 16:15:16.170 train.py:162] Eval loss: 0.7024075879770166
[05/27/2021 16:15:16.179 train.py:166] Eval AUC : 0.4976769126780169
[05/27/2021 16:15:16.180 train.py:167] Eval F1  : 0.49353115727002966
[05/27/2021 16:15:16.737 train.py: 90] 
----- Starting training phase 3 ------ Estimator Epoch: 2
[05/27/2021 16:15:16.737 train.py: 95] -------- Mini epoch: 0 --------
[05/27/2021 16:15:18.042 train.py:106] Sampling sub graph in  1.304 seconds
[05/27/2021 16:15:18.188 train.py:111] Building DataLoader in  0.146 seconds
[05/27/2021 16:15:18.634 train.py:133] Train loss: 0.06888641817150293
[05/27/2021 16:15:18.649 train.py:137] Train AUC : 0.577940237715957
[05/27/2021 16:15:18.649 train.py:138] Train F1  : 0.5674720519293184
[05/27/2021 16:15:18.649 train.py: 95] -------- Mini epoch: 1 --------
[05/27/2021 16:15:20.033 train.py:106] Sampling sub graph in  1.384 seconds
[05/27/2021 16:15:20.171 train.py:111] Building DataLoader in  0.138 seconds
[05/27/2021 16:15:20.604 train.py:133] Train loss: 0.07002050401987853
[05/27/2021 16:15:20.617 train.py:137] Train AUC : 0.5945083314114643
[05/27/2021 16:15:20.618 train.py:138] Train F1  : 0.5897670490534168
[05/27/2021 16:15:20.754 train.py:162] Eval loss: 0.7018557962249307
[05/27/2021 16:15:20.764 train.py:166] Eval AUC : 0.4955388134882393
[05/27/2021 16:15:20.765 train.py:167] Eval F1  : 0.49600751526538284
[05/27/2021 16:15:21.332 train.py: 90] 
----- Starting training phase 4 ------ Estimator Epoch: 2
[05/27/2021 16:15:21.333 train.py: 95] -------- Mini epoch: 0 --------
[05/27/2021 16:15:22.675 train.py:106] Sampling sub graph in  1.342 seconds
[05/27/2021 16:15:22.811 train.py:111] Building DataLoader in  0.137 seconds
[05/27/2021 16:15:23.242 train.py:133] Train loss: 0.07096515126802304
[05/27/2021 16:15:23.256 train.py:137] Train AUC : 0.6126062878381271
[05/27/2021 16:15:23.257 train.py:138] Train F1  : 0.5999149659863945
[05/27/2021 16:15:23.257 train.py: 95] -------- Mini epoch: 1 --------
[05/27/2021 16:15:24.618 train.py:106] Sampling sub graph in  1.361 seconds
[05/27/2021 16:15:24.761 train.py:111] Building DataLoader in  0.143 seconds
[05/27/2021 16:15:25.228 train.py:133] Train loss: 0.068683171092912
[05/27/2021 16:15:25.249 train.py:137] Train AUC : 0.6414381115869029
[05/27/2021 16:15:25.250 train.py:138] Train F1  : 0.6306671323786238
[05/27/2021 16:15:25.413 train.py:162] Eval loss: 0.701272577047348
[05/27/2021 16:15:25.424 train.py:166] Eval AUC : 0.4927862993896563
[05/27/2021 16:15:25.424 train.py:167] Eval F1  : 0.4950865699578849
